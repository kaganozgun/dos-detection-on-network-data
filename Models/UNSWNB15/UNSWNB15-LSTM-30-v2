{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"dknlsPwS_gXa","executionInfo":{"status":"ok","timestamp":1669322462523,"user_tz":-180,"elapsed":10947,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}}},"outputs":[],"source":["import pandas as pd\n","from io import StringIO\n","import io\n","from keras.models import Sequential\n","from keras.layers import LSTM, Dense\n","from keras.callbacks import EarlyStopping\n","from keras.metrics import FalseNegatives, FalsePositives\n","from keras.optimizers import Adam\n","import numpy as np\n","from sklearn.preprocessing import LabelEncoder\n","from sklearn.model_selection import train_test_split\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.metrics import confusion_matrix, classification_report, accuracy_score\n","import pickle"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"LD5VSBsX_4L1","executionInfo":{"status":"ok","timestamp":1669322462524,"user_tz":-180,"elapsed":5,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}}},"outputs":[],"source":["def predict_classes(model, x, batch_size=32, verbose=1):\n","    '''Generate class predictions for the input samples\n","    batch by batch.\n","    # Arguments\n","        x: input data, as a Numpy array or list of Numpy arrays\n","            (if the model has multiple inputs).\n","        batch_size: integer.\n","        verbose: verbosity mode, 0 or 1.\n","    # Returns\n","        A numpy array of class predictions.\n","    '''\n","    proba = model.predict(x, batch_size=batch_size, verbose=verbose)\n","    if proba.shape[-1] > 1:\n","        return proba.argmax(axis=-1)\n","    else:\n","        return (proba > 0.5).astype('int32')"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"vidtgfFl_8Pv","executionInfo":{"status":"ok","timestamp":1669322509207,"user_tz":-180,"elapsed":19766,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}}},"outputs":[],"source":["rate = 30\n","base_path = \"/content/drive/MyDrive/Okul/İTÜ/Bilgisayar Mühendisliği Yüksek Lisans/Yüksek Lisans/YL Tez/Development/UNSW-NB15\"\n","X_train = np.genfromtxt(f\"{base_path}/dataset/30-sampled-x-train.csv\", delimiter=',')\n","y_train = np.genfromtxt(f\"{base_path}/dataset/30-sampled-y-train.csv\", delimiter=',')\n","X_test = np.genfromtxt(f\"{base_path}/dataset/30-sampled-x-test.csv\", delimiter=',')\n","y_test = np.genfromtxt(f\"{base_path}/dataset/30-sampled-y-test.csv\", delimiter=',')"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"hXsTlGc-__6I","executionInfo":{"status":"ok","timestamp":1669322509207,"user_tz":-180,"elapsed":17,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}}},"outputs":[],"source":["y_train = y_train.astype(\"int64\")\n","y_test = y_test.astype(\"int64\")\n","\n","X_arr = np.asarray(X_train).astype(np.float32)\n","X_arr = np.resize(X_train,(X_train.shape[0],1,X_train.shape[1]))\n","\n","y_arr = np.asarray(y_train).astype(np.float32)"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"loaaA-UgCYE4","executionInfo":{"status":"ok","timestamp":1669325547209,"user_tz":-180,"elapsed":3038018,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}},"outputId":"f1737765-6206-4502-a83c-5f320e58ecbf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/130\n","3653/3653 [==============================] - 34s 8ms/step - loss: 0.0442 - false_negatives: 290.0000\n","Epoch 2/130\n","3653/3653 [==============================] - 30s 8ms/step - loss: 0.0203 - false_negatives: 61.0000\n","Epoch 3/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0183 - false_negatives: 56.0000\n","Epoch 4/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0168 - false_negatives: 60.0000\n","Epoch 5/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0158 - false_negatives: 54.0000\n","Epoch 6/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0145 - false_negatives: 61.0000\n","Epoch 7/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0142 - false_negatives: 67.0000\n","Epoch 8/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0137 - false_negatives: 65.0000\n","Epoch 9/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0133 - false_negatives: 77.0000\n","Epoch 10/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0133 - false_negatives: 69.0000\n","Epoch 11/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0128 - false_negatives: 70.0000\n","Epoch 12/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0126 - false_negatives: 58.0000\n","Epoch 13/130\n","3653/3653 [==============================] - 25s 7ms/step - loss: 0.0120 - false_negatives: 58.0000\n","Epoch 14/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0120 - false_negatives: 63.0000\n","Epoch 15/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0120 - false_negatives: 68.0000\n","Epoch 16/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0120 - false_negatives: 60.0000\n","Epoch 17/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0118 - false_negatives: 59.0000\n","Epoch 18/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0116 - false_negatives: 57.0000\n","Epoch 19/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0112 - false_negatives: 58.0000\n","Epoch 20/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0114 - false_negatives: 59.0000\n","Epoch 21/130\n","3653/3653 [==============================] - 25s 7ms/step - loss: 0.0110 - false_negatives: 57.0000\n","Epoch 22/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0110 - false_negatives: 54.0000\n","Epoch 23/130\n","3653/3653 [==============================] - 25s 7ms/step - loss: 0.0110 - false_negatives: 57.0000\n","Epoch 24/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0107 - false_negatives: 50.0000\n","Epoch 25/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0107 - false_negatives: 56.0000\n","Epoch 26/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0105 - false_negatives: 54.0000\n","Epoch 27/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0105 - false_negatives: 55.0000\n","Epoch 28/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0102 - false_negatives: 53.0000\n","Epoch 29/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0101 - false_negatives: 49.0000\n","Epoch 30/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0101 - false_negatives: 49.0000\n","Epoch 31/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0101 - false_negatives: 59.0000\n","Epoch 32/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0101 - false_negatives: 51.0000\n","Epoch 33/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0099 - false_negatives: 57.0000\n","Epoch 34/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0097 - false_negatives: 45.0000\n","Epoch 35/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0096 - false_negatives: 45.0000\n","Epoch 36/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0097 - false_negatives: 49.0000\n","Epoch 37/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0095 - false_negatives: 46.0000\n","Epoch 38/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0094 - false_negatives: 45.0000\n","Epoch 39/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0093 - false_negatives: 53.0000\n","Epoch 40/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0094 - false_negatives: 51.0000\n","Epoch 41/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0093 - false_negatives: 50.0000\n","Epoch 42/130\n","3653/3653 [==============================] - 27s 7ms/step - loss: 0.0091 - false_negatives: 40.0000\n","Epoch 43/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0092 - false_negatives: 52.0000\n","Epoch 44/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0090 - false_negatives: 42.0000\n","Epoch 45/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0091 - false_negatives: 40.0000\n","Epoch 46/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0089 - false_negatives: 41.0000\n","Epoch 47/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0089 - false_negatives: 46.0000\n","Epoch 48/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0089 - false_negatives: 45.0000\n","Epoch 49/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0087 - false_negatives: 38.0000\n","Epoch 50/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0087 - false_negatives: 39.0000\n","Epoch 51/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0086 - false_negatives: 48.0000\n","Epoch 52/130\n","3653/3653 [==============================] - 27s 7ms/step - loss: 0.0084 - false_negatives: 32.0000\n","Epoch 53/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0084 - false_negatives: 38.0000\n","Epoch 54/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0082 - false_negatives: 33.0000\n","Epoch 55/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0084 - false_negatives: 36.0000\n","Epoch 56/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0083 - false_negatives: 42.0000\n","Epoch 57/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0082 - false_negatives: 37.0000\n","Epoch 58/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0081 - false_negatives: 36.0000\n","Epoch 59/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0081 - false_negatives: 38.0000\n","Epoch 60/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0083 - false_negatives: 42.0000\n","Epoch 61/130\n","3653/3653 [==============================] - 27s 7ms/step - loss: 0.0078 - false_negatives: 25.0000\n","Epoch 62/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0080 - false_negatives: 37.0000\n","Epoch 63/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0079 - false_negatives: 35.0000\n","Epoch 64/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0077 - false_negatives: 36.0000\n","Epoch 65/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0078 - false_negatives: 34.0000\n","Epoch 66/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0076 - false_negatives: 34.0000\n","Epoch 67/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0075 - false_negatives: 40.0000\n","Epoch 68/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0073 - false_negatives: 32.0000\n","Epoch 69/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0075 - false_negatives: 33.0000\n","Epoch 70/130\n","3653/3653 [==============================] - 25s 7ms/step - loss: 0.0072 - false_negatives: 36.0000\n","Epoch 71/130\n","3653/3653 [==============================] - 24s 6ms/step - loss: 0.0073 - false_negatives: 34.0000\n","Epoch 72/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0074 - false_negatives: 28.0000\n","Epoch 73/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0072 - false_negatives: 37.0000\n","Epoch 74/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0071 - false_negatives: 31.0000\n","Epoch 75/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0071 - false_negatives: 31.0000\n","Epoch 76/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0068 - false_negatives: 31.0000\n","Epoch 77/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0069 - false_negatives: 28.0000\n","Epoch 78/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0067 - false_negatives: 31.0000\n","Epoch 79/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0065 - false_negatives: 26.0000\n","Epoch 80/130\n","3653/3653 [==============================] - 27s 7ms/step - loss: 0.0069 - false_negatives: 30.0000\n","Epoch 81/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0070 - false_negatives: 36.0000\n","Epoch 82/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0066 - false_negatives: 28.0000\n","Epoch 83/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0066 - false_negatives: 30.0000\n","Epoch 84/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0068 - false_negatives: 31.0000\n","Epoch 85/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0064 - false_negatives: 30.0000\n","Epoch 86/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0066 - false_negatives: 32.0000\n","Epoch 87/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0063 - false_negatives: 32.0000\n","Epoch 88/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0066 - false_negatives: 28.0000\n","Epoch 89/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0065 - false_negatives: 30.0000\n","Epoch 90/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0063 - false_negatives: 32.0000\n","Epoch 91/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0062 - false_negatives: 22.0000\n","Epoch 92/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0064 - false_negatives: 27.0000\n","Epoch 93/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0062 - false_negatives: 25.0000\n","Epoch 94/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0062 - false_negatives: 25.0000\n","Epoch 95/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0063 - false_negatives: 18.0000\n","Epoch 96/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0060 - false_negatives: 28.0000\n","Epoch 97/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0061 - false_negatives: 27.0000\n","Epoch 98/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0060 - false_negatives: 26.0000\n","Epoch 99/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0058 - false_negatives: 21.0000\n","Epoch 100/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0061 - false_negatives: 27.0000\n","Epoch 101/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0058 - false_negatives: 22.0000\n","Epoch 102/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0062 - false_negatives: 27.0000\n","Epoch 103/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0061 - false_negatives: 24.0000\n","Epoch 104/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0057 - false_negatives: 20.0000\n","Epoch 105/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0058 - false_negatives: 26.0000\n","Epoch 106/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0057 - false_negatives: 24.0000\n","Epoch 107/130\n","3653/3653 [==============================] - 27s 7ms/step - loss: 0.0057 - false_negatives: 26.0000\n","Epoch 108/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0055 - false_negatives: 25.0000\n","Epoch 109/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0055 - false_negatives: 21.0000\n","Epoch 110/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0054 - false_negatives: 22.0000\n","Epoch 111/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0053 - false_negatives: 21.0000\n","Epoch 112/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0055 - false_negatives: 21.0000\n","Epoch 113/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0053 - false_negatives: 18.0000\n","Epoch 114/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0052 - false_negatives: 27.0000\n","Epoch 115/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0052 - false_negatives: 23.0000\n","Epoch 116/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0050 - false_negatives: 21.0000\n","Epoch 117/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0052 - false_negatives: 20.0000\n","Epoch 118/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0052 - false_negatives: 27.0000\n","Epoch 119/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0051 - false_negatives: 22.0000\n","Epoch 120/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0052 - false_negatives: 23.0000\n","Epoch 121/130\n","3653/3653 [==============================] - 23s 6ms/step - loss: 0.0053 - false_negatives: 27.0000\n","Epoch 122/130\n","3653/3653 [==============================] - 24s 7ms/step - loss: 0.0049 - false_negatives: 18.0000\n","Epoch 123/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0049 - false_negatives: 22.0000\n","Epoch 124/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0049 - false_negatives: 24.0000\n","Epoch 125/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0048 - false_negatives: 22.0000\n","Epoch 126/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0050 - false_negatives: 17.0000\n","Epoch 127/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0051 - false_negatives: 24.0000\n","Epoch 128/130\n","3653/3653 [==============================] - 26s 7ms/step - loss: 0.0044 - false_negatives: 18.0000\n","Epoch 129/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0050 - false_negatives: 21.0000\n","Epoch 130/130\n","3653/3653 [==============================] - 22s 6ms/step - loss: 0.0046 - false_negatives: 22.0000\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.callbacks.History at 0x7eff5ec5d2d0>"]},"metadata":{},"execution_count":5}],"source":["# Model \n","model_1 = Sequential()\n","model_1.add(LSTM(100, activation='tanh', return_sequences=True, input_shape=(1, X_test.shape[1])))\n","model_1.add(LSTM(49, activation='tanh'))\n","model_1.add(Dense(1, activation='sigmoid'))\n","history=model_1.compile(optimizer=\"adam\", loss='binary_crossentropy', metrics=['FalseNegatives'])\n","\n","callback = EarlyStopping(monitor='false_negatives', patience=50)\n","model_1.fit(X_arr,y_arr,batch_size=10, epochs=130, callbacks=[callback])\n","#pickle.dump(model_1, open(f\"/content/drive/MyDrive/Okul/İTÜ/Bilgisayar Mühendisliği Yüksek Lisans/Yüksek Lisans/YL Tez/Development/UNSW-NB15/model/{rate}-LSTM-model.pkl\"))"]},{"cell_type":"code","source":["pickle.dump(model_1, open(f\"/content/drive/MyDrive/Okul/İTÜ/Bilgisayar Mühendisliği Yüksek Lisans/Yüksek Lisans/YL Tez/Development/UNSW-NB15/model/{rate}-LSTM-model.pkl\",\"wb\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"inaUO7IPmBBE","executionInfo":{"status":"ok","timestamp":1669325557164,"user_tz":-180,"elapsed":9960,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}},"outputId":"7a1c4a7d-a171-43e1-a20b-3e83b3b57d4b"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:Found untraced functions such as lstm_cell_layer_call_fn, lstm_cell_layer_call_and_return_conditional_losses, lstm_cell_1_layer_call_fn, lstm_cell_1_layer_call_and_return_conditional_losses while saving (showing 4 of 4). These functions will not be directly callable after loading.\n"]}]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"gS2ge-ETCe30","executionInfo":{"status":"ok","timestamp":1669325565406,"user_tz":-180,"elapsed":8256,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}},"outputId":"38348861-1c4e-4f82-86f9-a973ac7d1e37"},"outputs":[{"output_type":"stream","name":"stdout","text":["563/563 [==============================] - 2s 3ms/step\n","Model 1\n","[[12538    44]\n"," [   36  5371]]\n","              precision    recall  f1-score   support\n","\n","           0       1.00      1.00      1.00     12582\n","           1       0.99      0.99      0.99      5407\n","\n","    accuracy                           1.00     17989\n","   macro avg       0.99      0.99      0.99     17989\n","weighted avg       1.00      1.00      1.00     17989\n","\n","Accuracy: 0.99555283784535\n","False Positive rate: 0.9975540608149425\n","False Negative rate: 0.9979987770304075\n"]}],"source":["model_1 = pickle.load(open(f\"/content/drive/MyDrive/Okul/İTÜ/Bilgisayar Mühendisliği Yüksek Lisans/Yüksek Lisans/YL Tez/Development/UNSW-NB15/model/{rate}-LSTM-model.pkl\", 'rb'))\n","X_t = np.asarray(X_test).astype(np.float32)\n","X_t = np.resize(X_t,(X_t.shape[0],1,X_t.shape[1]))\n","y_pred = predict_classes(model_1,X_t)\n","print(\"Model 1\")\n","cm = confusion_matrix(y_test, y_pred)\n","print(cm)\n","print(classification_report(y_test, y_pred))\n","print(f\"Accuracy: {accuracy_score(y_test, y_pred)}\")\n","print(f\"False Positive rate: {1 - (cm[0][1] / len(y_test))}\")\n","print(f\"False Negative rate: {1 - (cm[1][0] / len(y_test))}\")"]},{"cell_type":"code","source":["np.savetxt(f\"{base_path}/model/lstm-y-pred.csv\", y_pred, delimiter=\",\")"],"metadata":{"id":"7LvWrVboYC9W","executionInfo":{"status":"ok","timestamp":1669325565406,"user_tz":-180,"elapsed":18,"user":{"displayName":"kagan özgün","userId":"16579487503936712173"}}},"execution_count":8,"outputs":[]}],"metadata":{"colab":{"provenance":[],"mount_file_id":"1drMEFfXi1Z7HTju0l-CQgFz89cTghdQ_","authorship_tag":"ABX9TyMcCt61rLwsPVkcni/hSUh3"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}